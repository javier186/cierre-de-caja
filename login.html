<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Login - Cierre de Caja</title>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>

<h2>üîê Iniciar sesi√≥n</h2>

<input type="email" id="email" placeholder="Correo">
<input type="password" id="password" placeholder="Contrase√±a">
<button onclick="login()">Entrar</button>

<script>
const firebaseConfig = {
  apiKey: "TU_API_KEY",
  authDomain: "TU_AUTH_DOMAIN",
  projectId: "TU_PROJECT_ID"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

async function login() {
  const email = email.value;
  const password = password.value;

  try {
    const cred = await auth.signInWithEmailAndPassword(email, password);
    const uid = cred.user.uid;

    const userDoc = await db.collection("usuarios").doc(uid).get();
    if (!userDoc.exists) {
      alert("Usuario sin permisos");
      return;
    }

    const data = userDoc.data();

    if (data.rol === "admin") {
      window.location.href = "supervisor-dashboard.html";
    } else if (data.rol === "tienda") {
      window.location.href = "registro-tienda.html";
    } else {
      alert("Rol no v√°lido");
    }

  } catch (e) {
    alert("Error: " + e.message);
  }
}
</script>
</body>
</html>
